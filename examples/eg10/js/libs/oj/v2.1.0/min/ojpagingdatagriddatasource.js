/**
 * Copyright (c) 2014, 2016, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","ojs/ojpagingtabledatasource"],function(a){a.ml=function(a,c){this.JM=a;this.gr=c};o_("PagingCellSet",a.ml,a);a.ml.prototype.getData=function(a){return this.JM.getData({column:a.column,row:a.row+this.gr})};a.b.g("PagingCellSet.prototype.getData",{getData:a.ml.prototype.getData});a.ml.prototype.getMetadata=function(a){return this.JM.getMetadata({column:a.column,row:a.row+this.gr})};a.b.g("PagingCellSet.prototype.getMetadata",{getMetadata:a.ml.prototype.getMetadata});a.ml.prototype.getCount=
function(a){return this.JM.getCount(a)};a.b.g("PagingCellSet.prototype.getCount",{getCount:a.ml.prototype.getCount});a.ml.prototype.Pea=function(){return this.JM};a.b.g("PagingCellSet.prototype.getCellSet",{Pea:a.ml.prototype.Pea});a.ml.prototype.dF=function(){return this.gr};a.b.g("PagingCellSet.prototype.getStartIndex",{dF:a.ml.prototype.dF});a.ob=function(g){if(!(g instanceof a.Br))throw new a.ia("Not a datagridatasource","Not a datagridatasource",a.ia.Xc.ERROR);this.Ld=g;this.pa=0;this.Init()};
o_("PagingDataGridDataSource",a.ob,a);a.b.ta(a.ob,a.Br,"oj.PagingDataGridDataSource");a.ob.prototype.Init=function(){a.ob.u.Init.call(this);this.bE()};a.b.g("PagingDataGridDataSource.prototype.Init",{Init:a.ob.prototype.Init});a.ob.prototype.bE=function(){this.Ld.on("change",this.Jua.bind(this))};a.ob.prototype.getPage=function(){return this.ge};a.b.g("PagingDataGridDataSource.prototype.getPage",{getPage:a.ob.prototype.getPage});a.ob.prototype.setPage=function(g,c){c=c||{};g=parseInt(g,10);try{a.ob.u.handleEvent.call(this,
a.ad.Q.BEFOREPAGE,{page:g,previousPage:this.ge})}catch(b){return Promise.reject(null)}this.Fb=null!=c.pageSize?c.pageSize:this.Fb;c.startIndex=g*this.Fb;var d=this.ge;this.ge=g;this.pa=c.startIndex;var e=this;return new Promise(function(a,b){e.Bg(c).then(function(){a(null)},function(){e.ge=d;e.pa=e.ge*e.Fb;b(null)})})};a.b.g("PagingDataGridDataSource.prototype.setPage",{setPage:a.ob.prototype.setPage});a.ob.prototype.Bg=function(a){this.pq=!0;this.pa=a.startIndex;var c=this;return new Promise(function(a){c.handleEvent("change",
{operation:"sync",pageSize:c.Fb});a(void 0)})};a.ob.prototype.fetch=function(a){this.Fb=a.pageSize+a.startIndex;a.startIndex=0;return this.Bg(a)};a.b.g("PagingDataGridDataSource.prototype.fetch",{fetch:a.ob.prototype.fetch});a.ob.prototype.getStartItemIndex=function(){return this.pa};a.b.g("PagingDataGridDataSource.prototype.getStartItemIndex",{getStartItemIndex:a.ob.prototype.getStartItemIndex});a.ob.prototype.getEndItemIndex=function(){return this.Dk};a.b.g("PagingDataGridDataSource.prototype.getEndItemIndex",
{getEndItemIndex:a.ob.prototype.getEndItemIndex});a.ob.prototype.getPageCount=function(){var a=this.totalSize();return-1==a?-1:Math.ceil(a/this.Fb)};a.b.g("PagingDataGridDataSource.prototype.getPageCount",{getPageCount:a.ob.prototype.getPageCount});a.ob.prototype.Jua=function(g){switch(g.operation){case "refresh":this.pa=0;this.handleEvent("change",{operation:"sync",pageSize:this.Fb});this.handleEvent(a.Fa.Q.REFRESH,null);break;case "reset":this.handleEvent(a.Fa.Q.RESET,null);break;case "insert":this.handleEvent(a.Fa.Q.ADD,
{index:g.indexes.row});break;case "delete":this.handleEvent(a.Fa.Q.REMOVE,null);break;case "update":g.indexes.row=0<=g.indexes.row-this.pa?g.indexes.row-this.pa:-1;this.handleEvent("change",g);break;default:this.handleEvent("change",g),this.handleEvent(a.Fa.Q.SYNC,null)}};a.ob.prototype.getCount=function(a){var c=this.Ld.getCount(a);return"row"===a&&0<=c?this.pa+this.Fb<c?this.Fb:c-this.pa:c};a.b.g("PagingDataGridDataSource.prototype.getCount",{getCount:a.ob.prototype.getCount});a.ob.prototype.getCountPrecision=
function(a){return this.Ld.getCountPrecision(a)};a.b.g("PagingDataGridDataSource.prototype.getCountPrecision",{getCountPrecision:a.ob.prototype.getCountPrecision});a.ob.prototype.fetchHeaders=function(a,c,b){null==this.pq?null!=c&&c.success&&c.success.call(b.success,null,a,null):"row"===a.axis?(a.start+=this.pa,a.start+a.count>this.pa+this.Fb&&(a.count=this.Fb-a.start),this.Pv={headerRange:a,callbacks:c,callbackObjects:b},this.Ld.fetchHeaders(a,{success:this.UT.bind(this),error:this.nwa.bind(this)},
b)):this.Ld.fetchHeaders(a,c,b)};a.b.g("PagingDataGridDataSource.prototype.fetchHeaders",{fetchHeaders:a.ob.prototype.fetchHeaders});a.ob.prototype.UT=function(g,c,b){var d,e;this.Pv.headerRange==c&&(c.start-=this.pa,c.count+=1,null!=g&&(d=new a.Sf(g,this.pa)),null!=b&&(e=new a.Sf(b,this.pa)),g=this.Pv.callbacks.success,b=this.Pv.callbackObjects.success,this.Pv=null,g.call(b,d,c,e))};a.ob.prototype.nwa=function(a){var c,b;c=this.Pv.callbacks.error;b=this.Pv.callbackObjects.error;this.Pv=null;c.call(b,
a)};a.ob.prototype.fetchCells=function(a,c,b){var d;if(null==this.pq)d={getData:function(){return null},getMetaData:function(){return null},getStart:function(){return 0},getCount:function(){return 0},getLevelCount:function(){return 0},getExtent:function(){return 0},getDepth:function(){return 1}},null!=c&&c.success&&c.success.call(b.success,d,a);else{for(d=0;d<a.length;d+=1)"row"===a[d].axis&&(a[d].start+=this.pa,a[d].start+a[d].count>this.pa+this.Fb&&(a[d].count=this.Fb-a[d].start));this.Ov={cellRanges:a,
callbacks:c,callbackObjects:b};this.Ld.fetchCells(a,{success:this.Iua.bind(this),error:this.Hua.bind(this)},b)}};a.b.g("PagingDataGridDataSource.prototype.fetchCells",{fetchCells:a.ob.prototype.fetchCells});a.ob.prototype.Iua=function(g,c){var b,d,e;if(!this.Ov.cellRanges!=c){for(b=0;b<c.length;b+=1)"row"===c[b].axis&&(c[b].start-=this.pa,c[b].count+=1);b=new a.ml(g,this.pa);d=this.Ov.callbacks.success;e=this.Ov.callbackObjects.success;this.Ov=null;this.Dk=this.pa+g.getCount("row")-1;this.handleEvent("sync",
{data:Array(g.getCount("row")),startIndex:this.pa});d.call(e,b,c)}};a.ob.prototype.Hua=function(a){var c,b;c=this.Ov.callbacks.error;b=this.Ov.callbackObjects.error;this.Ov=null;c.call(b,a)};a.ob.prototype.keys=function(a){return this.Ld.keys({column:a.column,row:a.row+this.pa})};a.b.g("PagingDataGridDataSource.prototype.keys",{keys:a.ob.prototype.keys});a.ob.prototype.indexes=function(a){a=this.Ld.indexes(a);-1!=a.row&&(a.row-=this.pa);return a};a.b.g("PagingDataGridDataSource.prototype.indexes",
{indexes:a.ob.prototype.indexes});a.ob.prototype.getCapability=function(a){return this.Ld.getCapability(a)};a.b.g("PagingDataGridDataSource.prototype.getCapability",{getCapability:a.ob.prototype.getCapability});a.ob.prototype.size=function(){var a;if(null==this.pq)return-1;a=this.Ld.getCount("row");return this.Ld.getCount("row")>this.Fb?this.Fb:a};a.b.g("PagingDataGridDataSource.prototype.size",{size:a.ob.prototype.size});a.ob.prototype.sort=function(a,c,b){this.Ld.sort(a,c,b)};a.b.g("PagingDataGridDataSource.prototype.sort",
{sort:a.ob.prototype.sort});a.ob.prototype.totalSize=function(){return null==this.pq?-1:this.Ld.getCount("row")};a.b.g("PagingDataGridDataSource.prototype.totalSize",{totalSize:a.ob.prototype.totalSize});a.ob.prototype.totalSizeConfidence=function(){return"actual"};a.b.g("PagingDataGridDataSource.prototype.totalSizeConfidence",{totalSizeConfidence:a.ob.prototype.totalSizeConfidence});a.ob.prototype.moveOK=function(a,c,b){return this.Ld.moveOK(a,c,b)};a.b.g("PagingDataGridDataSource.prototype.moveOK",
{moveOK:a.ob.prototype.moveOK});a.ob.prototype.move=function(a,c,b,d,e){this.Ld.move(a,c,b,d,e)};a.b.g("PagingDataGridDataSource.prototype.move",{move:a.ob.prototype.move});a.Sf=function(a,c){this.Ew=a;this.gr=c};o_("PagingHeaderSet",a.Sf,a);a.Sf.prototype.getData=function(a,c){return this.Ew.getData(a+this.gr,c)};a.b.g("PagingHeaderSet.prototype.getData",{getData:a.Sf.prototype.getData});a.Sf.prototype.getMetadata=function(a,c){return this.Ew.getMetadata(a+this.gr,c)};a.b.g("PagingHeaderSet.prototype.getMetadata",
{getMetadata:a.Sf.prototype.getMetadata});a.Sf.prototype.getCount=function(){return this.Ew.getCount()};a.b.g("PagingHeaderSet.prototype.getCount",{getCount:a.Sf.prototype.getCount});a.Sf.prototype.getLevelCount=function(){return this.Ew.getLevelCount()};a.b.g("PagingHeaderSet.prototype.getLevelCount",{getLevelCount:a.Sf.prototype.getLevelCount});a.Sf.prototype.getExtent=function(a,c){return this.Ew.getExtent(a+this.gr,c)};a.b.g("PagingHeaderSet.prototype.getExtent",{getExtent:a.Sf.prototype.getExtent});
a.Sf.prototype.getDepth=function(a,c){return this.Ew.getDepth(a+this.gr,c)};a.b.g("PagingHeaderSet.prototype.getDepth",{getDepth:a.Sf.prototype.getDepth});a.Sf.prototype.gfa=function(){return this.Ew};a.b.g("PagingHeaderSet.prototype.getHeaderSet",{gfa:a.Sf.prototype.gfa});a.Sf.prototype.dF=function(){return this.gr};a.b.g("PagingHeaderSet.prototype.getStartIndex",{dF:a.Sf.prototype.dF})});